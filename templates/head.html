<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="description" content="{{ config.description }}" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Open Graph -->
  <meta property="og:site_name" content="{{ config.title }}" />
  <meta property="og:title" content="{%- if page.title -%}{{- page.title }} - {{ config.title -}}{%- elif section.title -%}{{- section.title }} - {{ config.title -}}{%- else -%}{{- config.title -}}{%- endif -%}" />
  <meta property="og:url" content="{{ current_url | default(value='/') }}" />
  <meta property="og:description" content="{{ page.description | default(value=config.description) }}" />

  <title>
    {%- if page.title -%}
      {{- page.title }} - {{ config.title -}}
    {%- elif section.title -%}
      {{- section.title }} - {{ config.title -}}
    {%- else -%}
      {{- config.title -}}
    {%- endif -%}
  </title>

  <link rel="canonical" href="{{ current_url | default(value='/') }}" />
  <link rel="stylesheet" type="text/css" href="{{ get_url(path='css/main.css') }}" />
  <link rel="stylesheet" type="text/css" href="{{ get_url(path='css/fonts.css') }}" />
  <link rel="apple-touch-icon" sizes="180x180" href="{{ get_url(path='icon/apple-touch-icon.png') }}" />
  <link rel="icon" type="image/png" sizes="32x32" href="{{ get_url(path='icon/favicon-32x32.png') }}" />
  <link rel="icon" type="image/png" sizes="16x16" href="{{ get_url(path='icon/favicon-16x16.png') }}" />
  <link rel="manifest" href="{{ get_url(path='icon/site.webmanifest') }}" />

  {% if config.extra.google_analytics %}
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id={{config.extra.google_analytics}}"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', '{{config.extra.google_analytics}}');
    </script>
  {% endif %}

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
  <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>

  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11.9.0/dist/mermaid.esm.min.mjs';

    function getCSSVariable(variable, fallback) {
      if (typeof window !== 'undefined' && typeof document !== 'undefined') {
        return getComputedStyle(document.documentElement).getPropertyValue(variable).trim() || fallback;
      }
      return fallback;
    };

    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        primaryColor: getCSSVariable('--mermaid-primary-color', '#ede9fe'),
        primaryTextColor: getCSSVariable('--mermaid-primary-text-color', '#6d28d9'),
        primaryBorderColor: getCSSVariable('--mermaid-primary-border-color', '#c4b5fd'),
        lineColor: getCSSVariable('--mermaid-line-color', '#a78bfa'),
        secondaryColor: getCSSVariable('--mermaid-secondary-color', '#f0fdf4'),
        secondaryTextColor: getCSSVariable('--mermaid-secondary-text-color', '#047857'),
        secondaryBorderColor: getCSSVariable('--mermaid-secondary-border-color', '#86efac'),
        tertiaryColor: getCSSVariable('--mermaid-tertiary-color', '#fff7ed'),
        tertiaryTextColor: getCSSVariable('--mermaid-tertiary-text-color', '#c2410c'),
        tertiaryBorderColor: getCSSVariable('--mermaid-tertiary-border-color', '#fdba74'),
        edgeLabelBackground: getCSSVariable('--mermaid-edge-label-background', '#ffffff'),
        edgeLabelColor: getCSSVariable('--mermaid-edge-label-color', '#4a5568'),
        fontSize: '14px',
        fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif'
      },
      flowchart: {
        padding: 8,
        nodeSpacing: 40,
        rankSpacing: 40,
        curve: 'basis'
      },
      sequence: {
        diagramMarginX: 8,
        diagramMarginY: 8,
        actorMargin: 40,
        boxMargin: 8,
        boxTextMargin: 4,
        noteMargin: 8,
        messageMargin: 30
      },
      gantt: {
        titleTopMargin: 15,
        barHeight: 18,
        barGap: 3,
        topPadding: 40,
        leftPadding: 60,
        gridLineStartPadding: 30,
        fontSize: 12
      }
    });
  </script>

</head>
